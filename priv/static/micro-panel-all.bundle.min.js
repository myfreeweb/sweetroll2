!function(){"use strict";var e='"SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace',t="\n  .codeflask {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n  }\n\n  .codeflask, .codeflask * {\n    box-sizing: border-box;\n  }\n\n  .codeflask__pre {\n    pointer-events: none;\n    z-index: 3;\n    overflow: hidden;\n  }\n\n  .codeflask__textarea {\n    background: none;\n    border: none;\n    color: "+(CSS.supports("caret-color","#000")?"#fff":"#ccc")+";\n    z-index: 1;\n    resize: none;\n    font-family: "+e+";\n    -webkit-appearance: pre;\n    caret-color: #111;\n    z-index: 2;\n    width: 100%;\n    height: 100%;\n  }\n\n  .codeflask--has-line-numbers .codeflask__textarea {\n    width: calc(100% - 40px);\n  }\n\n  .codeflask__code {\n    display: block;\n    font-family: "+e+";\n    overflow: hidden;\n  }\n\n  .codeflask__flatten {\n    padding: 10px;\n    font-size: 13px;\n    line-height: 20px;\n    white-space: pre;\n    position: absolute;\n    top: 0;\n    left: 0;\n    overflow: auto;\n    margin: 0 !important;\n    outline: none;\n    text-align: left;\n  }\n\n  .codeflask__flatten.word-wrap {\n    white-space: pre-wrap;\n    word-wrap: break-word;\n  }\n\n  .codeflask--has-line-numbers .codeflask__flatten {\n    width: calc(100% - 40px);\n    left: 40px;\n  }\n\n  .codeflask__line-highlight {\n    position: absolute;\n    top: 10px;\n    left: 0;\n    width: 100%;\n    height: 20px;\n    background: rgba(0,0,0,0.1);\n    z-index: 1;\n  }\n\n  .codeflask__lines {\n    padding: 10px 4px;\n    font-size: 12px;\n    line-height: 20px;\n    font-family: 'Cousine', monospace;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 40px;\n    height: 100%;\n    text-align: right;\n    color: #999;\n    z-index: 2;\n  }\n\n  .codeflask__lines__line {\n    display: block;\n  }\n\n  .codeflask.codeflask--has-line-numbers {\n    padding-left: 40px;\n  }\n\n  .codeflask.codeflask--has-line-numbers:before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 40px;\n    height: 100%;\n    background: #eee;\n    z-index: 1;\n  }\n";function n(e,t,n){var r=t||"codeflask-style",i=n||document.head;if(!e)return!1;if(document.getElementById(r))return!0;var o=document.createElement("style");return o.innerHTML=e,o.id=r,i.appendChild(o),!0}var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function i(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return r[e]})}var o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var s,a=(function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},n=function(){var e=/\blang(?:uage)?-([\w-]+)\b/i,n=0,r=t.Prism={manual:t.Prism&&t.Prism.manual,disableWorkerMessageHandler:t.Prism&&t.Prism.disableWorkerMessageHandler,util:{encode:function(e){return e instanceof i?new i(e.type,r.util.encode(e.content),e.alias):"Array"===r.util.type(e)?e.map(r.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++n}),e.__id},clone:function(e,t){var n=r.util.type(e);switch(t=t||{},n){case"Object":if(t[r.util.objId(e)])return t[r.util.objId(e)];var i={};for(var o in t[r.util.objId(e)]=i,e)e.hasOwnProperty(o)&&(i[o]=r.util.clone(e[o],t));return i;case"Array":return t[r.util.objId(e)]?t[r.util.objId(e)]:(i=[],t[r.util.objId(e)]=i,e.forEach(function(e,n){i[n]=r.util.clone(e,t)}),i)}return e}},languages:{extend:function(e,t){var n=r.util.clone(r.languages[e]);for(var i in t)n[i]=t[i];return n},insertBefore:function(e,t,n,i){var o=(i=i||r.languages)[e];if(2==arguments.length){for(var s in n=arguments[1])n.hasOwnProperty(s)&&(o[s]=n[s]);return o}var a={};for(var l in o)if(o.hasOwnProperty(l)){if(l==t)for(var s in n)n.hasOwnProperty(s)&&(a[s]=n[s]);a[l]=o[l]}return r.languages.DFS(r.languages,function(t,n){n===i[e]&&t!=e&&(this[t]=a)}),i[e]=a},DFS:function(e,t,n,i){for(var o in i=i||{},e)e.hasOwnProperty(o)&&(t.call(e,o,e[o],n||o),"Object"!==r.util.type(e[o])||i[r.util.objId(e[o])]?"Array"!==r.util.type(e[o])||i[r.util.objId(e[o])]||(i[r.util.objId(e[o])]=!0,r.languages.DFS(e[o],t,o,i)):(i[r.util.objId(e[o])]=!0,r.languages.DFS(e[o],t,null,i)))}},plugins:{},highlightAll:function(e,t){r.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,n){var i={callback:n,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};r.hooks.run("before-highlightall",i);for(var o,s=i.elements||e.querySelectorAll(i.selector),a=0;o=s[a++];)r.highlightElement(o,!0===t,i.callback)},highlightElement:function(n,i,o){for(var s,a,l=n;l&&!e.test(l.className);)l=l.parentNode;l&&(s=(l.className.match(e)||[,""])[1].toLowerCase(),a=r.languages[s]),n.className=n.className.replace(e,"").replace(/\s+/g," ")+" language-"+s,n.parentNode&&(l=n.parentNode,/pre/i.test(l.nodeName)&&(l.className=l.className.replace(e,"").replace(/\s+/g," ")+" language-"+s));var c={element:n,language:s,grammar:a,code:n.textContent};if(r.hooks.run("before-sanity-check",c),!c.code||!c.grammar)return c.code&&(r.hooks.run("before-highlight",c),c.element.textContent=c.code,r.hooks.run("after-highlight",c)),void r.hooks.run("complete",c);if(r.hooks.run("before-highlight",c),i&&t.Worker){var d=new Worker(r.filename);d.onmessage=function(e){c.highlightedCode=e.data,r.hooks.run("before-insert",c),c.element.innerHTML=c.highlightedCode,o&&o.call(c.element),r.hooks.run("after-highlight",c),r.hooks.run("complete",c)},d.postMessage(JSON.stringify({language:c.language,code:c.code,immediateClose:!0}))}else c.highlightedCode=r.highlight(c.code,c.grammar,c.language),r.hooks.run("before-insert",c),c.element.innerHTML=c.highlightedCode,o&&o.call(n),r.hooks.run("after-highlight",c),r.hooks.run("complete",c)},highlight:function(e,t,n){var o={code:e,grammar:t,language:n};return r.hooks.run("before-tokenize",o),o.tokens=r.tokenize(o.code,o.grammar),r.hooks.run("after-tokenize",o),i.stringify(r.util.encode(o.tokens),o.language)},matchGrammar:function(e,t,n,i,o,s,a){var l=r.Token;for(var c in n)if(n.hasOwnProperty(c)&&n[c]){if(c==a)return;var d=n[c];d="Array"===r.util.type(d)?d:[d];for(var u=0;u<d.length;++u){var p=d[u],h=p.inside,f=!!p.lookbehind,g=!!p.greedy,m=0,y=p.alias;if(g&&!p.pattern.global){var b=p.pattern.toString().match(/[imuy]*$/)[0];p.pattern=RegExp(p.pattern.source,b+"g")}p=p.pattern||p;for(var v=i,w=o;v<t.length;w+=t[v].length,++v){var k=t[v];if(t.length>e.length)return;if(!(k instanceof l)){if(g&&v!=t.length-1){if(p.lastIndex=w,!(E=p.exec(e)))break;for(var _=E.index+(f?E[1].length:0),x=E.index+E[0].length,S=v,P=w,C=t.length;S<C&&(P<x||!t[S].type&&!t[S-1].greedy);++S)_>=(P+=t[S].length)&&(++v,w=P);if(t[v]instanceof l)continue;A=S-v,k=e.slice(w,P),E.index-=w}else{p.lastIndex=0;var E=p.exec(k),A=1}if(E){f&&(m=E[1]?E[1].length:0),x=(_=E.index+m)+(E=E[0].slice(m)).length;var $=k.slice(0,_),N=k.slice(x),L=[v,A];$&&(++v,w+=$.length,L.push($));var j=new l(c,h?r.tokenize(E,h):E,y,E,g);if(L.push(j),N&&L.push(N),Array.prototype.splice.apply(t,L),1!=A&&r.matchGrammar(e,t,n,v,w,!0,c),s)break}else if(s)break}}}}},tokenize:function(e,t,n){var i=[e],o=t.rest;if(o){for(var s in o)t[s]=o[s];delete t.rest}return r.matchGrammar(e,i,t,0,0,!1),i},hooks:{all:{},add:function(e,t){var n=r.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=r.hooks.all[e];if(n&&n.length)for(var i,o=0;i=n[o++];)i(t)}}},i=r.Token=function(e,t,n,r,i){this.type=e,this.content=t,this.alias=n,this.length=0|(r||"").length,this.greedy=!!i};if(i.stringify=function(e,t,n){if("string"==typeof e)return e;if("Array"===r.util.type(e))return e.map(function(n){return i.stringify(n,t,e)}).join("");var o={type:e.type,content:i.stringify(e.content,t,n),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:n};if(e.alias){var s="Array"===r.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(o.classes,s)}r.hooks.run("wrap",o);var a=Object.keys(o.attributes).map(function(e){return e+'="'+(o.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+o.tag+' class="'+o.classes.join(" ")+'"'+(a?" "+a:"")+">"+o.content+"</"+o.tag+">"},!t.document)return t.addEventListener?(r.disableWorkerMessageHandler||t.addEventListener("message",function(e){var n=JSON.parse(e.data),i=n.language,o=n.code,s=n.immediateClose;t.postMessage(r.highlight(o,r.languages[i],i)),s&&t.close()},!1),t.Prism):t.Prism;var o=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return o&&(r.filename=o.src,r.manual||o.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(r.highlightAll):window.setTimeout(r.highlightAll,16):document.addEventListener("DOMContentLoaded",r.highlightAll))),t.Prism}();e.exports&&(e.exports=n),void 0!==o&&(o.Prism=n),n.languages.markup={comment:/<!--[\s\S]*?-->/,prolog:/<\?[\s\S]+?\?>/,doctype:/<!DOCTYPE[\s\S]+?>/i,cdata:/<!\[CDATA\[[\s\S]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+))?)*\s*\/?>/i,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+)/i,inside:{punctuation:[/^=/,{pattern:/(^|[^\\])["']/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),n.languages.xml=n.languages.markup,n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(?:;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^{}\s][^{};]*?(?=\s*\{)/,string:{pattern:/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/[-_a-z\xA0-\uFFFF][-\w\xA0-\uFFFF]*(?=\s*:)/i,important:/\B!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},n.languages.css.atrule.inside.rest=n.languages.css,n.languages.markup&&(n.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\s\S]*?>)[\s\S]*?(?=<\/style>)/i,lookbehind:!0,inside:n.languages.css,alias:"language-css",greedy:!0}}),n.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|')(?:\\[\s\S]|(?!\1)[^\\])*\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:n.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:n.languages.css}},alias:"language-css"}},n.languages.markup.tag)),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(?:true|false)\b/,function:/[a-z0-9_]+(?=\()/i,number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{keyword:/\b(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b(?:0[xX][\dA-Fa-f]+|0[bB][01]+|0[oO][0-7]+|NaN|Infinity)\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee][+-]?\d+)?/,function:/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*\()/i,operator:/-[-=]?|\+[+=]?|!=?=?|<<?=?|>>?>?=?|=(?:==?|>)?|&[&=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/}),n.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s])\s*)\/(\[[^\]\r\n]+]|\\.|[^/\\\[\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0},"function-variable":{pattern:/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*=\s*(?:function\b|(?:\([^()]*\)|[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)\s*=>))/i,alias:"function"},constant:/\b[A-Z][A-Z\d_]*\b/}),n.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\[\s\S]|[^\\`])*`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}}}),n.languages.markup&&n.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\s\S]*?>)[\s\S]*?(?=<\/script>)/i,lookbehind:!0,inside:n.languages.javascript,alias:"language-javascript",greedy:!0}}),n.languages.js=n.languages.javascript,"undefined"!=typeof self&&self.Prism&&self.document&&document.querySelector&&(self.Prism.fileHighlight=function(){var e={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"};Array.prototype.slice.call(document.querySelectorAll("pre[data-src]")).forEach(function(t){for(var r,i=t.getAttribute("data-src"),o=t,s=/\blang(?:uage)?-(?!\*)([\w-]+)\b/i;o&&!s.test(o.className);)o=o.parentNode;if(o&&(r=(t.className.match(s)||[,""])[1]),!r){var a=(i.match(/\.(\w+)$/)||[,""])[1];r=e[a]||a}var l=document.createElement("code");l.className="language-"+r,t.textContent="",l.textContent="Loading…",t.appendChild(l);var c=new XMLHttpRequest;c.open("GET",i,!0),c.onreadystatechange=function(){4==c.readyState&&(c.status<400&&c.responseText?(l.textContent=c.responseText,n.highlightElement(l)):c.status>=400?l.textContent="✖ Error "+c.status+" while fetching file: "+c.statusText:l.textContent="✖ Error: File does not exist or is empty")},t.hasAttribute("data-download-link")&&n.plugins.toolbar&&n.plugins.toolbar.registerButton("download-file",function(){var e=document.createElement("a");return e.textContent=t.getAttribute("data-download-link-label")||"Download",e.setAttribute("download",""),e.href=i,e}),c.send(null)})},document.addEventListener("DOMContentLoaded",self.Prism.fileHighlight))}(s={exports:{}},s.exports),s.exports),l=function(e,t){if(!e)throw Error("CodeFlask expects a parameter which is Element or a String selector");if(!t)throw Error("CodeFlask expects an object containing options as second parameter");if(e.nodeType)this.editorRoot=e;else{var n=document.querySelector(e);n&&(this.editorRoot=n)}this.opts=t,this.startEditor()};l.prototype.startEditor=function(){if(!n(t,null,this.opts.styleParent))throw Error("Failed to inject CodeFlask CSS.");this.createWrapper(),this.createTextarea(),this.createPre(),this.createCode(),this.runOptions(),this.listenTextarea(),this.populateDefault(),this.updateCode(this.code)},l.prototype.createWrapper=function(){this.code=this.editorRoot.innerHTML,this.editorRoot.innerHTML="",this.elWrapper=this.createElement("div",this.editorRoot),this.elWrapper.classList.add("codeflask")},l.prototype.createTextarea=function(){this.elTextarea=this.createElement("textarea",this.elWrapper),this.elTextarea.classList.add("codeflask__textarea","codeflask__flatten")},l.prototype.createPre=function(){this.elPre=this.createElement("pre",this.elWrapper),this.elPre.classList.add("codeflask__pre","codeflask__flatten")},l.prototype.createCode=function(){this.elCode=this.createElement("code",this.elPre),this.elCode.classList.add("codeflask__code","language-"+(this.opts.language||"html"))},l.prototype.createLineNumbers=function(){this.elLineNumbers=this.createElement("div",this.elWrapper),this.elLineNumbers.classList.add("codeflask__lines"),this.setLineNumber()},l.prototype.createElement=function(e,t){var n=document.createElement(e);return t.appendChild(n),n},l.prototype.runOptions=function(){this.opts.rtl=this.opts.rtl||!1,this.opts.tabSize=this.opts.tabSize||2,this.opts.enableAutocorrect=this.opts.enableAutocorrect||!1,this.opts.lineNumbers=this.opts.lineNumbers||!1,this.opts.defaultTheme=!1!==this.opts.defaultTheme,this.opts.wordWrap=this.opts.wordWrap||!1,!0===this.opts.rtl&&(this.elTextarea.setAttribute("dir","rtl"),this.elPre.setAttribute("dir","rtl")),!1===this.opts.enableAutocorrect&&(this.elTextarea.setAttribute("spellcheck","false"),this.elTextarea.setAttribute("autocapitalize","off"),this.elTextarea.setAttribute("autocomplete","off"),this.elTextarea.setAttribute("autocorrect","off")),this.opts.lineNumbers&&(this.elWrapper.classList.add("codeflask--has-line-numbers"),this.createLineNumbers()),this.opts.defaultTheme&&n("\n.codeflask {\n  background: #fff;\n  color: #4f559c;\n}\n\n.codeflask .token.punctuation {\n  color: #4a4a4a;\n}\n\n.codeflask .token.keyword {\n  color: #8500ff;\n}\n\n.codeflask .token.operator {\n  color: #ff5598;\n}\n\n.codeflask .token.string {\n  color: #41ad8f;\n}\n\n.codeflask .token.comment {\n  color: #9badb7;\n}\n\n.codeflask .token.function {\n  color: #8500ff;\n}\n\n.codeflask .token.boolean {\n  color: #8500ff;\n}\n\n.codeflask .token.number {\n  color: #8500ff;\n}\n\n.codeflask .token.selector {\n  color: #8500ff;\n}\n\n.codeflask .token.property {\n  color: #8500ff;\n}\n\n.codeflask .token.tag {\n  color: #8500ff;\n}\n\n.codeflask .token.attr-value {\n  color: #8500ff;\n}\n","theme-default",this.opts.styleParent),this.opts.wordWrap&&(this.elTextarea.classList.add("word-wrap"),this.elPre.classList.add("word-wrap"))},l.prototype.updateLineNumbersCount=function(){for(var e="",t=1;t<=this.lineNumber;t++)e=e+'<span class="codeflask__lines__line">'+t+"</span>";this.elLineNumbers.innerHTML=e},l.prototype.listenTextarea=function(){var e=this;this.elTextarea.addEventListener("input",function(t){e.code=t.target.value,e.elCode.innerHTML=i(t.target.value),e.highlight(),setTimeout(function(){e.runUpdate(),e.setLineNumber()},1)}),this.elTextarea.addEventListener("keydown",function(t){e.handleTabs(t),e.handleSelfClosingCharacters(t),e.handleNewLineIndentation(t)}),this.elTextarea.addEventListener("scroll",function(t){e.elPre.style.transform="translate3d(-"+t.target.scrollLeft+"px, -"+t.target.scrollTop+"px, 0)",e.elLineNumbers&&(e.elLineNumbers.style.transform="translate3d(0, -"+t.target.scrollTop+"px, 0)")})},l.prototype.handleTabs=function(e){if(9===e.keyCode){e.preventDefault(),e.keyCode;var t=this.elTextarea.selectionStart,n=this.elTextarea.selectionEnd,r=""+this.code.substring(0,t)+" ".repeat(this.opts.tabSize)+this.code.substring(n);this.updateCode(r),this.elTextarea.selectionEnd=n+this.opts.tabSize}},l.prototype.handleSelfClosingCharacters=function(e){var t=e.key;if(["(","[","{","<"].includes(t))switch(t){case"(":this.closeCharacter(")");break;case"[":this.closeCharacter("]");break;case"{":this.closeCharacter("}");break;case"<":this.closeCharacter(">")}},l.prototype.setLineNumber=function(){this.lineNumber=this.code.split("\n").length,this.opts.lineNumbers&&this.updateLineNumbersCount()},l.prototype.handleNewLineIndentation=function(e){e.keyCode},l.prototype.closeCharacter=function(e){var t=this.elTextarea.selectionStart,n=this.elTextarea.selectionEnd,r=""+this.code.substring(0,t)+e+this.code.substring(n);this.updateCode(r),this.elTextarea.selectionEnd=n},l.prototype.updateCode=function(e){this.code=e,this.elTextarea.value=e,this.elCode.innerHTML=i(e),this.highlight(),setTimeout(this.runUpdate,1)},l.prototype.updateLanguage=function(e){var t=this.opts.language;this.elCode.classList.remove("language-"+t),this.elCode.classList.add("language-"+e),this.opts.language=e,this.highlight()},l.prototype.addLanguage=function(e,t){a.languages[e]=t},l.prototype.populateDefault=function(){this.updateCode(this.code)},l.prototype.highlight=function(){a.highlightElement(this.elCode,!1)},l.prototype.onUpdate=function(e){if(e&&"[object Function]"!=={}.toString.call(e))throw Error("CodeFlask expects callback of type Function");this.updateCallBack=e},l.prototype.getCode=function(){return this.code},l.prototype.runUpdate=function(){this.updateCallBack&&this.updateCallBack(this.code)};customElements.define("code-flask",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML+="<style> :host { display: block; position: relative;\n\t\t\t\toverflow-x: auto; min-height: 100px; }\n\t\t\t.codeflask .token.title { color: var(--codeflask-title, #000) }\n\t\t\t.codeflask .token.punctuation { color: var(--codeflask-punctuation, #6a6a6a) }\n\t\t\t.codeflask .token.keyword { color: var(--codeflask-keyword, #8500ff) }\n\t\t\t.codeflask .token.operator { color: var(--codeflask-operator, #ff5598) }\n\t\t\t.codeflask .token.string { color: var(--codeflask-string, #41ad8f) }\n\t\t\t.codeflask .token.comment { color: var(--codeflask-comment, #9badb7) }\n\t\t\t.codeflask .token.function { color: var(--codeflask-function, #8500ff) }\n\t\t\t.codeflask .token.boolean { color: var(--codeflask-boolean, #8500ff) }\n\t\t\t.codeflask .token.number { color: var(--codeflask-number, #8500ff) }\n\t\t\t.codeflask .token.selector { color: var(--codeflask-selector, #8500ff) }\n\t\t\t.codeflask .token.property { color: var(--codeflask-property, #8500ff) }\n\t\t\t.codeflask .token.tag { color: var(--codeflask-tag, #8500ff) }\n\t\t\t.codeflask .token.attr-value { color: var(--codeflask-attr-value, #8500ff) }\n\t\t\t.codeflask .token.url { color: var(--codeflask-url, #4040ff) }\n\t\t\t.codeflask .token.italic { font-style: italic }\n\t\t\t.codeflask .token.bold { font-weight: bolder }\n\t\t</style>",this.editorElement=document.createElement("div"),this.editorElement.style.width="100%",this.editorElement.style.height="100%",this.editorElement.style.position="absolute",this.shadowRoot.appendChild(this.editorElement),this.flask=new l(this.editorElement,{language:this.getAttribute("language")||"markup",wordWrap:this.hasAttribute("word-wrap"),lineNumbers:this.lineNumbers,rtl:"rtl"===this.dir,defaultTheme:!1,styleParent:this.shadowRoot}),this.flask.onUpdate(e=>{this.dispatchEvent(new CustomEvent("value-changed"))}),this.value=this.getAttribute("value"),this.value||(this.initElement=document.createElement("div"),this.shadowRoot.appendChild(this.initElement),this.initSlot=document.createElement("slot"),this.initElement.appendChild(this.initSlot))}connectedCallback(){if(this.initSlot){let e="";for(const t of this.initSlot.assignedNodes())e+=t.outerHTML||t.textContent;this.initElement.removeChild(this.initSlot),this.shadowRoot.removeChild(this.initElement),e.length>0&&(this.value=e)}}get value(){return this.flask.getCode()}set value(e){return this.removeAttribute("value"),this.flask.updateCode(e)}get language(){return this.flask.opts.language}set language(e){e&&(this.flask.updateLanguage(e),this.dispatchEvent(new CustomEvent("language-changed")))}get dir(){return this.getAttribute("dir")||"ltr"}get lineNumbers(){return this.hasAttribute("line-numbers")}static get observedAttributes(){return["language","value"]}attributeChangedCallback(e,t,n){this[e]=n}}),Prism.languages.markdown=Prism.languages.extend("markup",{}),Prism.languages.insertBefore("markdown","prolog",{blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},code:[{pattern:/^(?: {4}|\t).+/m,alias:"keyword"},{pattern:/``.+?``|`[^`\n]+`/,alias:"keyword"}],title:[{pattern:/\w+.*(?:\r?\n|\r)(?:==+|--+)/,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#+.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:/(^|[^\\])(\*\*|__)(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^\*\*|^__|\*\*$|__$/}},italic:{pattern:/(^|[^\\])([*_])(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^[*_]|[*_]$/}},url:{pattern:/!?\[[^\]]+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)| ?\[[^\]\n]*\])/,inside:{variable:{pattern:/(!?\[)[^\]]+(?=\]$)/,lookbehind:!0},string:{pattern:/"(?:\\.|[^"\\])*"(?=\)$)/}}}}),Prism.languages.markdown.bold.inside.url=Prism.languages.markdown.url,Prism.languages.markdown.italic.inside.url=Prism.languages.markdown.url,Prism.languages.markdown.bold.inside.italic=Prism.languages.markdown.italic,Prism.languages.markdown.italic.inside.bold=Prism.languages.markdown.bold,Prism.languages.json={property:/"(?:\\.|[^\\"\r\n])*"(?=\s*:)/i,string:{pattern:/"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,greedy:!0},number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee][+-]?\d+)?/,punctuation:/[{}[\]);,]/,operator:/:/g,boolean:/\b(?:true|false)\b/i,null:/\bnull\b/i},Prism.languages.jsonp=Prism.languages.json;const c=new WeakMap,d=e=>"function"==typeof e&&c.has(e),u=void 0!==window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,p=(e,t,n=null,r=null)=>{for(;t!==n;){const n=t.nextSibling;e.insertBefore(t,r),t=n}},h=(e,t,n=null)=>{for(;t!==n;){const n=t.nextSibling;e.removeChild(t),t=n}},f={},g={},m=`{{lit-${String(Math.random()).slice(2)}}}`,y=`\x3c!--${m}--\x3e`,b=new RegExp(`${m}|${y}`),v="$lit$";class w{constructor(e,t){this.parts=[],this.element=t;const n=[],r=[],i=document.createTreeWalker(t.content,133,null,!1);let o=0,s=-1,a=0;const{strings:l,values:{length:c}}=e;for(;a<c;){const e=i.nextNode();if(null!==e){if(s++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:n}=t;let r=0;for(let e=0;e<n;e++)k(t[e].name,v)&&r++;for(;r-- >0;){const t=l[a],n=S.exec(t)[2],r=n.toLowerCase()+v,i=e.getAttribute(r);e.removeAttribute(r);const o=i.split(b);this.parts.push({type:"attribute",index:s,name:n,strings:o}),a+=o.length-1}}"TEMPLATE"===e.tagName&&(r.push(e),i.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(m)>=0){const r=e.parentNode,i=t.split(b),o=i.length-1;for(let t=0;t<o;t++){let n,o=i[t];if(""===o)n=x();else{const e=S.exec(o);null!==e&&k(e[2],v)&&(o=o.slice(0,e.index)+e[1]+e[2].slice(0,-v.length)+e[3]),n=document.createTextNode(o)}r.insertBefore(n,e),this.parts.push({type:"node",index:++s})}""===i[o]?(r.insertBefore(x(),e),n.push(e)):e.data=i[o],a+=o}}else if(8===e.nodeType)if(e.data===m){const t=e.parentNode;null!==e.previousSibling&&s!==o||(s++,t.insertBefore(x(),e)),o=s,this.parts.push({type:"node",index:s}),null===e.nextSibling?e.data="":(n.push(e),s--),a++}else{let t=-1;for(;-1!==(t=e.data.indexOf(m,t+1));)this.parts.push({type:"node",index:-1}),a++}}else i.currentNode=r.pop()}for(const e of n)e.parentNode.removeChild(e)}}const k=(e,t)=>{const n=e.length-t.length;return n>=0&&e.slice(n)===t},_=e=>-1!==e.index,x=()=>document.createComment(""),S=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class P{constructor(e,t,n){this.__parts=[],this.template=e,this.processor=t,this.options=n}update(e){let t=0;for(const n of this.__parts)void 0!==n&&n.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=u?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],n=this.template.parts,r=document.createTreeWalker(e,133,null,!1);let i,o=0,s=0,a=r.nextNode();for(;o<n.length;)if(i=n[o],_(i)){for(;s<i.index;)s++,"TEMPLATE"===a.nodeName&&(t.push(a),r.currentNode=a.content),null===(a=r.nextNode())&&(r.currentNode=t.pop(),a=r.nextNode());if("node"===i.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(a.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(a,i.name,i.strings,this.options));o++}else this.__parts.push(void 0),o++;return u&&(document.adoptNode(e),customElements.upgrade(e)),e}}class C{constructor(e,t,n,r){this.strings=e,this.values=t,this.type=n,this.processor=r}getHTML(){const e=this.strings.length-1;let t="",n=!1;for(let r=0;r<e;r++){const e=this.strings[r],i=e.lastIndexOf("\x3c!--");n=(i>-1||n)&&-1===e.indexOf("--\x3e",i+1);const o=S.exec(e);t+=null===o?e+(n?m:y):e.substr(0,o.index)+o[1]+o[2]+v+o[3]+m}return t+=this.strings[e]}getTemplateElement(){const e=document.createElement("template");return e.innerHTML=this.getHTML(),e}}const E=e=>null===e||!("object"==typeof e||"function"==typeof e),A=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class ${constructor(e,t,n){this.dirty=!0,this.element=e,this.name=t,this.strings=n,this.parts=[];for(let e=0;e<n.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new N(this)}_getValue(){const e=this.strings,t=e.length-1;let n="";for(let r=0;r<t;r++){n+=e[r];const t=this.parts[r];if(void 0!==t){const e=t.value;if(E(e)||!A(e))n+="string"==typeof e?e:String(e);else for(const t of e)n+="string"==typeof t?t:String(t)}}return n+=e[t]}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class N{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===f||E(e)&&e===this.value||(this.value=e,d(e)||(this.committer.dirty=!0))}commit(){for(;d(this.value);){const e=this.value;this.value=f,e(this)}this.value!==f&&this.committer.commit()}}class L{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(x()),this.endNode=e.appendChild(x())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=x()),e.__insert(this.endNode=x())}insertAfterPart(e){e.__insert(this.startNode=x()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){for(;d(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=f,e(this)}const e=this.__pendingValue;e!==f&&(E(e)?e!==this.value&&this.__commitText(e):e instanceof C?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):A(e)?this.__commitIterable(e):e===g?(this.value=g,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,n="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=n:this.__commitNode(document.createTextNode(n)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof P&&this.value.template===t)this.value.update(e.values);else{const n=new P(t,e.processor,this.options),r=n._clone();n.update(e.values),this.__commitNode(r),this.value=n}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let n,r=0;for(const i of e)void 0===(n=t[r])&&(n=new L(this.options),t.push(n),0===r?n.appendIntoPart(this):n.insertAfterPart(t[r-1])),n.setValue(i),n.commit(),r++;r<t.length&&(t.length=r,this.clear(n&&n.endNode))}clear(e=this.startNode){h(this.startNode.parentNode,e.nextSibling,this.endNode)}}class j{constructor(e,t,n){if(this.value=void 0,this.__pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=n}setValue(e){this.__pendingValue=e}commit(){for(;d(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=f,e(this)}if(this.__pendingValue===f)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=f}}class T extends ${constructor(e,t,n){super(e,t,n),this.single=2===n.length&&""===n[0]&&""===n[1]}_createPart(){return new O(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class O extends N{}let z=!1;try{const e={get capture(){return z=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}class F{constructor(e,t,n){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=n,this.__boundHandleEvent=(e=>this.handleEvent(e))}setValue(e){this.__pendingValue=e}commit(){for(;d(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=f,e(this)}if(this.__pendingValue===f)return;const e=this.__pendingValue,t=this.value,n=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),r=null!=e&&(null==t||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=M(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=f}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const M=e=>e&&(z?{capture:e.capture,passive:e.passive,once:e.once}:e.capture);const V=new class{handleAttributeExpressions(e,t,n,r){const i=t[0];return"."===i?new T(e,t.slice(1),n).parts:"@"===i?[new F(e,t.slice(1),r.eventContext)]:"?"===i?[new j(e,t.slice(1),n)]:new $(e,t,n).parts}handleTextExpression(e){return new L(e)}};function I(e){let t=H.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},H.set(e.type,t));let n=t.stringsArray.get(e.strings);if(void 0!==n)return n;const r=e.strings.join(m);return void 0===(n=t.keyString.get(r))&&(n=new w(e,e.getTemplateElement()),t.keyString.set(r,n)),t.stringsArray.set(e.strings,n),n}const H=new Map,R=new WeakMap;(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.1");const U=(e,...t)=>new C(e,t,"html",V),D=(e,...t)=>new class extends C{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const e=super.getTemplateElement(),t=e.content,n=t.firstChild;return t.removeChild(n),p(t,n.firstChild),e}}(e,t,"svg",V),B=133;function q(e,t){const{element:{content:n},parts:r}=e,i=document.createTreeWalker(n,B,null,!1);let o=J(r),s=r[o],a=-1,l=0;const c=[];let d=null;for(;i.nextNode();){a++;const e=i.currentNode;for(e.previousSibling===d&&(d=null),t.has(e)&&(c.push(e),null===d&&(d=e)),null!==d&&l++;void 0!==s&&s.index===a;)s.index=null!==d?-1:s.index-l,s=r[o=J(r,o)]}c.forEach(e=>e.parentNode.removeChild(e))}const W=e=>{let t=11===e.nodeType?0:1;const n=document.createTreeWalker(e,B,null,!1);for(;n.nextNode();)t++;return t},J=(e,t=-1)=>{for(let n=t+1;n<e.length;n++){const t=e[n];if(_(t))return n}return-1};const Q=(e,t)=>`${e}--${t}`;let Z=!0;void 0===window.ShadyCSS?Z=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),Z=!1);const G=["html","svg"],K=new Set,X=(e,t,n)=>{K.add(e);const r=n?n.element:document.createElement("template"),i=t.querySelectorAll("style"),{length:o}=i;if(0===o)return void window.ShadyCSS.prepareTemplateStyles(r,e);const s=document.createElement("style");for(let e=0;e<o;e++){const t=i[e];t.parentNode.removeChild(t),s.textContent+=t.textContent}e=e,G.forEach(t=>{const n=H.get(Q(t,e));void 0!==n&&n.keyString.forEach(e=>{const{element:{content:t}}=e,n=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{n.add(e)}),q(e,n)})});const a=r.content;n?function(e,t,n=null){const{element:{content:r},parts:i}=e;if(null===n||void 0===n)return void r.appendChild(t);const o=document.createTreeWalker(r,B,null,!1);let s=J(i),a=0,l=-1;for(;o.nextNode();)for(l++,o.currentNode===n&&(a=W(t),n.parentNode.insertBefore(t,n));-1!==s&&i[s].index===l;){if(a>0){for(;-1!==s;)i[s].index+=a,s=J(i,s);return}s=J(i,s)}}(n,s,a.firstChild):a.insertBefore(s,a.firstChild),window.ShadyCSS.prepareTemplateStyles(r,e);const l=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==l)t.insertBefore(l.cloneNode(!0),t.firstChild);else if(n){a.insertBefore(s,a.firstChild);const e=new Set;e.add(s),q(n,e)}};var Y;window.JSCompiler_renameProperty=((e,t)=>e);const ee={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},te=(e,t)=>t!==e&&(t==t||e==e),ne={attribute:!0,type:String,converter:ee,reflect:!1,hasChanged:te},re=Promise.resolve(!0),ie=1,oe=4,se=8,ae=16,le=32;class ce extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=re,this._hasConnectedResolver=void 0,this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,n)=>{const r=this._attributeNameForProperty(n,t);void 0!==r&&(this._attributeToPropertyMap.set(r,n),e.push(r))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=ne){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const n="symbol"==typeof e?Symbol():`__${e}`;Object.defineProperty(this.prototype,e,{get(){return this[n]},set(t){const r=this[e];this[n]=t,this._requestUpdate(e,r)},configurable:!0,enumerable:!0})}static finalize(){if(this.hasOwnProperty(JSCompiler_renameProperty("finalized",this))&&this.finalized)return;const e=Object.getPrototypeOf(this);if("function"==typeof e.finalize&&e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const n of t)this.createProperty(n,e[n])}}static _attributeNameForProperty(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,n=te){return n(e,t)}static _propertyValueFromAttribute(e,t){const n=t.type,r=t.converter||ee,i="function"==typeof r?r:r.fromAttribute;return i?i(e,n):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const n=t.type,r=t.converter;return(r&&r.toAttribute||ee.toAttribute)(e,n)}initialize(){this._saveInstanceProperties(),this._requestUpdate()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this._updateState=this._updateState|le,this._hasConnectedResolver&&(this._hasConnectedResolver(),this._hasConnectedResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,n){t!==n&&this._attributeToProperty(e,n)}_propertyToAttribute(e,t,n=ne){const r=this.constructor,i=r._attributeNameForProperty(e,n);if(void 0!==i){const e=r._propertyValueToAttribute(t,n);if(void 0===e)return;this._updateState=this._updateState|se,null==e?this.removeAttribute(i):this.setAttribute(i,e),this._updateState=this._updateState&~se}}_attributeToProperty(e,t){if(this._updateState&se)return;const n=this.constructor,r=n._attributeToPropertyMap.get(e);if(void 0!==r){const e=n._classProperties.get(r)||ne;this._updateState=this._updateState|ae,this[r]=n._propertyValueFromAttribute(t,e),this._updateState=this._updateState&~ae}}_requestUpdate(e,t){let n=!0;if(void 0!==e){const r=this.constructor,i=r._classProperties.get(e)||ne;r._valueHasChanged(this[e],t,i.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==i.reflect||this._updateState&ae||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,i))):n=!1}!this._hasRequestedUpdate&&n&&this._enqueueUpdate()}requestUpdate(e,t){return this._requestUpdate(e,t),this.updateComplete}async _enqueueUpdate(){let e,t;this._updateState=this._updateState|oe;const n=this._updatePromise;this._updatePromise=new Promise((n,r)=>{e=n,t=r});try{await n}catch(e){}this._hasConnected||await new Promise(e=>this._hasConnectedResolver=e);try{const e=this.performUpdate();null!=e&&await e}catch(e){t(e)}e(!this._hasRequestedUpdate)}get _hasConnected(){return this._updateState&le}get _hasRequestedUpdate(){return this._updateState&oe}get hasUpdated(){return this._updateState&ie}performUpdate(){this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{(e=this.shouldUpdate(t))&&this.update(t)}catch(t){throw e=!1,t}finally{this._markUpdated()}e&&(this._updateState&ie||(this._updateState=this._updateState|ie,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=this._updateState&~oe}get updateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0)}updated(e){}firstUpdated(e){}}ce.finalized=!0;const de="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,ue=Symbol();class pe{constructor(e,t){if(t!==ue)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(de?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const he=(e,...t)=>{const n=t.reduce((t,n,r)=>t+(e=>{if(e instanceof pe)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(n)+e[r+1],e[0]);return new pe(n,ue)};(window.litElementVersions||(window.litElementVersions=[])).push("2.2.0");const fe=e=>e.flat?e.flat(1/0):function e(t,n=[]){for(let r=0,i=t.length;r<i;r++){const i=t[r];Array.isArray(i)?e(i,n):n.push(i)}return n}(e);class ge extends ce{static finalize(){super.finalize(),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}static _getUniqueStyles(){const e=this.styles,t=[];if(Array.isArray(e)){fe(e).reduceRight((e,t)=>(e.add(t),e),new Set).forEach(e=>t.unshift(e))}else e&&t.push(e);return t}initialize(){super.initialize(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?de?this.renderRoot.adoptedStyleSheets=e.map(e=>e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){super.update(e);const t=this.render();t instanceof C&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){}}function me(){return document.querySelector("micro-panel-editor")}function ye(e){console.error(e),alert(e.toString())}function be(e,t,n,r){return new Promise((i,o)=>{const s=new XMLHttpRequest;if(s.upload.addEventListener("progress",r,!1),s.addEventListener("load",e=>{if(s.status>=200&&s.status<300){const e=s.getResponseHeader("Content-Type");e&&e.includes("application/json")?i(JSON.parse(s.responseText)):i(s.getResponseHeader("Location"))}else o(s.status)}),s.addEventListener("error",o),s.addEventListener("abort",o),s.addEventListener("timeout",o),s.upload.addEventListener("error",o),s.upload.addEventListener("abort",o),s.upload.addEventListener("timeout",o),s.open("post",e),t)s.setRequestHeader("Authorization","MediaToken "+t);else{const e=document.cookie.split("; ").find(e=>"Bearer"===e.split("=")[0]);e?s.setRequestHeader("Authorization","Bearer "+e):s.withCredentials=!0}const a=new FormData;a.append("file",n),s.send(a)})}ge.finalized=!0,ge.render=((e,t,n)=>{if(!n||"object"!=typeof n||!n.scopeName)throw new Error("The `scopeName` option is required.");const r=n.scopeName,i=R.has(t),o=Z&&11===t.nodeType&&!!t.host,s=o&&!K.has(r),a=s?document.createDocumentFragment():t;if(((e,t,n)=>{let r=R.get(t);void 0===r&&(h(t,t.firstChild),R.set(t,r=new L(Object.assign({templateFactory:I},n))),r.appendInto(t)),r.setValue(e),r.commit()})(e,a,Object.assign({templateFactory:(e=>t=>{const n=Q(t.type,e);let r=H.get(n);void 0===r&&(r={stringsArray:new WeakMap,keyString:new Map},H.set(n,r));let i=r.stringsArray.get(t.strings);if(void 0!==i)return i;const o=t.strings.join(m);if(void 0===(i=r.keyString.get(o))){const n=t.getTemplateElement();Z&&window.ShadyCSS.prepareTemplateDom(n,e),i=new w(t,n),r.keyString.set(o,i)}return r.stringsArray.set(t.strings,i),i})(r)},n)),s){const e=R.get(a);R.delete(a);const n=e.value instanceof P?e.value.template:void 0;X(r,a,n),h(t,t.firstChild),t.appendChild(a),R.set(t,e)}!i&&o&&window.ShadyCSS.styleElement(t.host)});const ve=he`
		:host {
			line-height: 1.15;
			-webkit-text-size-adjust: 100%;
			--major-padding: var(--micro-panel-major-padding, 0.5rem);
			--roundness: var(--micro-panel-roundness, 4px);
			--neutral: var(--micro-panel-neutral, #fefefe);
			--neutral-hover: var(--micro-panel-neutral, #ebebeb);
			--accent: var(--micro-panel-accent, rgb(0, 137, 123));
			--accent-hover: var(--micro-panel-accent-hover, rgb(0, 107, 103));
			--light-accent: var(--micro-panel-light-accent, rgba(0, 137, 123, 0.55));
			--text: var(--micro-panel-text, #333);
			color: var(--text);
		}
		:host([hidden]) { display: none !important; }
		* { box-sizing: border-box; }

		input, textarea, button {
			text-transform: none;
			border-radius: var(--roundness);
			padding: 0.4rem;
			outline: none;
			border: 1px solid var(--accent);
			vertical-align: baseline;
		}
		::-moz-focus-inner {
			border-style: none;
			padding: 0;
		}
		input:-moz-focusring, textarea:-moz-focusring, button:-moz-focusring {
			outline: 1px dotted ButtonText;
		}
		button {
			padding: 0.4rem 0.8rem;
			overflow: visible;
			-webkit-appearance: button;
			background: var(--accent);
			color: var(--neutral);
			transition: 0.15s ease-in transform;
		}
		button:focus {
			transform: scale(1.1);
		}
		button:not([disabled]):active {
			transform: scale(0.9);
		}
		button:hover {
			background: var(--accent-hover);
		}
		button[disabled] {
			opacity: 0.5;
		}

		a {
			color: var(--accent);
		}
		a:hover {
			color: var(--accent-hover);
		}

		.icon, .icon-button {
			vertical-align: middle;
		}
		.icon-button {
			padding: 0.2rem;
			border-radius: 100rem;
			background: transparent;
			color: inherit;
			border: none;
		}
		.icon-button:hover {
			background: rgba(10, 10, 10, 0.2);
		}

		.inverted {
			background: var(--accent);
			color: var(--neutral);
		}
		.inverted button {
			background: var(--neutral);
			color: var(--accent);
			border-color: var(--neutral);
		}
		.inverted button:hover {
			background: var(--neutral-hover);
		}

		.header-bar {
			padding: var(--major-padding);
		}
		.bar {
			margin: 0;
			display: flex;
			align-items: baseline;
		}
		.bar label, .bar h1, .bar .stretchy {
			flex: 1;
		}
		.bar > * {
			margin: 0 0.4rem;
		}
		.bar > *:first-child {
			margin-left: 0;
		}
		.bar > * + * {
			margin-right: 0;
		}
		.bar h1 {
			margin: 0;
			font-size: 1.1rem;
		}
		.bar button {
			font-size: 1rem;
		}
`,we={plus:D`
		<path fill="currentColor" d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" />
	`,minus:D`
		<path fill="currentColor" d="M19,13H5V11H19V13Z" />
	`,chevronUp:D`
		<path fill="currentColor" d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z" />
	`,chevronDown:D`
		<path fill="currentColor" d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z" />
	`,leadPencil:D`
		<path fill="currentColor" d="M16.84,2.73C16.45,2.73 16.07,2.88 15.77,3.17L13.65,5.29L18.95,10.6L21.07,8.5C21.67,7.89 21.67,6.94 21.07,6.36L17.9,3.17C17.6,2.88 17.22,2.73 16.84,2.73M12.94,6L4.84,14.11L7.4,14.39L7.58,16.68L9.86,16.85L10.15,19.41L18.25,11.3M4.25,15.04L2.5,21.73L9.2,19.94L8.96,17.78L6.65,17.61L6.47,15.29" />
	`,close:D`
		<path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
	`,cloudUpload:D`
		<path fill="currentColor" d="M14,13V17H10V13H7L12,8L17,13M19.35,10.03C18.67,6.59 15.64,4 12,4C9.11,4 6.6,5.64 5.35,8.03C2.34,8.36 0,10.9 0,14A6,6 0 0,0 6,20H19A5,5 0 0,0 24,15C24,12.36 21.95,10.22 19.35,10.03Z" />
	`,json:D`
		<path fill="currentColor" d="M5,3H7V5H5V10A2,2 0 0,1 3,12A2,2 0 0,1 5,14V19H7V21H5C3.93,20.73 3,20.1 3,19V15A2,2 0 0,0 1,13H0V11H1A2,2 0 0,0 3,9V5A2,2 0 0,1 5,3M19,3A2,2 0 0,1 21,5V9A2,2 0 0,0 23,11H24V13H23A2,2 0 0,0 21,15V19A2,2 0 0,1 19,21H17V19H19V14A2,2 0 0,1 21,12A2,2 0 0,1 19,10V5H17V3H19M12,15A1,1 0 0,1 13,16A1,1 0 0,1 12,17A1,1 0 0,1 11,16A1,1 0 0,1 12,15M8,15A1,1 0 0,1 9,16A1,1 0 0,1 8,17A1,1 0 0,1 7,16A1,1 0 0,1 8,15M16,15A1,1 0 0,1 17,16A1,1 0 0,1 16,17A1,1 0 0,1 15,16A1,1 0 0,1 16,15Z" />
	`,mapMarkerPlus:D`
		<path fill="currentColor" d="M9,11.5A2.5,2.5 0 0,0 11.5,9A2.5,2.5 0 0,0 9,6.5A2.5,2.5 0 0,0 6.5,9A2.5,2.5 0 0,0 9,11.5M9,2C12.86,2 16,5.13 16,9C16,14.25 9,22 9,22C9,22 2,14.25 2,9A7,7 0 0,1 9,2M15,17H18V14H20V17H23V19H20V22H18V19H15V17Z" />
	`};function ke(e,t=null){return U`<svg class="icon" width="24" height="24" viewBox="0 0 24 24" role="img" ?aria-hidden=${t} title=${t||""}>
		${e}
		${t?U`<title>${t}</title>`:""}
	</svg>`}var _e,xe="undefined"!=typeof Symbol?Symbol("immer-nothing"):((_e={})["immer-nothing"]=!0,_e),Se="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("immer-draftable"):"__$immer_draftable",Pe="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("immer-state"):"__$immer_state";function Ce(e){return!!e&&!!e[Pe]}function Ee(e){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e))return!0;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype||(!!e[Se]||!!e.constructor[Se])}var Ae=Object.assign||function(e,t){for(var n in t)Te(t,n)&&(e[n]=t[n]);return e},$e="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function Ne(e,t){if(void 0===t&&(t=!1),Array.isArray(e))return e.slice();var n=Object.create(Object.getPrototypeOf(e));return $e(e).forEach(function(r){if(r!==Pe){var i=Object.getOwnPropertyDescriptor(e,r),o=i.value;if(i.get){if(!t)throw new Error("Immer drafts cannot have computed properties");o=i.get.call(e)}i.enumerable?n[r]=o:Object.defineProperty(n,r,{value:o,writable:!0,configurable:!0})}}),n}function Le(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(n,e[n],e);else $e(e).forEach(function(n){return t(n,e[n],e)})}function je(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!!n&&n.enumerable}function Te(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Oe(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var ze=function(e){this.drafts=[],this.parent=e,this.canAutoFreeze=!0,this.patches=null};function Fe(e){e[Pe].revoke()}ze.prototype.usePatches=function(e){e&&(this.patches=[],this.inversePatches=[],this.patchListener=e)},ze.prototype.revoke=function(){this.leave(),this.drafts.forEach(Fe),this.drafts=null},ze.prototype.leave=function(){this===ze.current&&(ze.current=this.parent)},ze.current=null,ze.enter=function(){return this.current=new ze(this.current)};var Me={};function Ve(e,t){var n=Array.isArray(e),r=Be(e);Le(r,function(t){!function(e,t,n){var r=Me[t];r?r.enumerable=n:Me[t]=r={configurable:!0,enumerable:n,get:function(){return function(e,t){qe(e);var n=Re(He(e),t);if(e.finalizing)return n;if(n===Re(e.base,t)&&Ee(n))return De(e),e.copy[t]=Ve(n,e);return n}(this[Pe],t)},set:function(e){!function(e,t,n){if(qe(e),e.assigned[t]=!0,!e.modified){if(Oe(n,Re(He(e),t)))return;Ue(e),De(e)}e.copy[t]=n}(this[Pe],t,e)}};Object.defineProperty(e,t,r)}(r,t,n||je(e,t))});var i,o,s,a=t?t.scope:ze.current;return i=r,o=Pe,s={scope:a,modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:t,base:e,draft:r,copy:null,revoke:Ie,revoked:!1},Object.defineProperty(i,o,{value:s,enumerable:!1,writable:!0}),a.drafts.push(r),r}function Ie(){this.revoked=!0}function He(e){return e.copy||e.base}function Re(e,t){var n=e[Pe];if(n&&!n.finalizing){n.finalizing=!0;var r=e[t];return n.finalizing=!1,r}return e[t]}function Ue(e){e.modified||(e.modified=!0,e.parent&&Ue(e.parent))}function De(e){e.copy||(e.copy=Be(e.base))}function Be(e){var t=e&&e[Pe];if(t){t.finalizing=!0;var n=Ne(t.draft,!0);return t.finalizing=!1,n}return Ne(e)}function qe(e){if(!0===e.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(He(e)))}function We(e){for(var t=e.length-1;t>=0;t--){var n=e[t][Pe];n.modified||(Array.isArray(n.base)?Qe(n)&&Ue(n):Je(n)&&Ue(n))}}function Je(e){for(var t=e.base,n=e.draft,r=Object.keys(n),i=r.length-1;i>=0;i--){var o=r[i],s=t[o];if(void 0===s&&!Te(t,o))return!0;var a=n[o],l=a&&a[Pe];if(l?l.base!==s:!Oe(a,s))return!0}return r.length!==Object.keys(t).length}function Qe(e){var t=e.draft;if(t.length!==e.base.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var Ze=Object.freeze({willFinalize:function(e,t,n){e.drafts.forEach(function(e){e[Pe].finalizing=!0}),n?Ce(t)&&t[Pe].scope===e&&We(e.drafts):(e.patches&&function e(t){if(t&&"object"==typeof t){var n=t[Pe];if(n){var r=n.base,i=n.draft,o=n.assigned;if(Array.isArray(t)){if(Qe(n)){if(Ue(n),o.length=!0,i.length<r.length)for(var s=i.length;s<r.length;s++)o[s]=!1;else for(var a=r.length;a<i.length;a++)o[a]=!0;for(var l=0;l<i.length;l++)void 0===o[l]&&e(i[l])}}else Object.keys(i).forEach(function(t){void 0!==r[t]||Te(r,t)?o[t]||e(i[t]):(o[t]=!0,Ue(n))}),Object.keys(r).forEach(function(e){void 0!==i[e]||Te(i,e)||(o[e]=!1,Ue(n))})}}}(e.drafts[0]),We(e.drafts))},createProxy:Ve});function Ge(e,t){var n=t?t.scope:ze.current,r={scope:n,modified:!1,finalized:!1,assigned:{},parent:t,base:e,draft:null,drafts:{},copy:null,revoke:null},i=Array.isArray(e)?Proxy.revocable([r],Xe):Proxy.revocable(r,Ke),o=i.revoke,s=i.proxy;return r.draft=s,r.revoke=o,n.drafts.push(s),s}var Ke={get:function(e,t){if(t===Pe)return e;var n=e.drafts;if(!e.modified&&Te(n,t))return n[t];var r=Ye(e)[t];if(e.finalized||!Ee(r))return r;if(e.modified){if(r!==et(e.base,t))return r;n=e.copy}return n[t]=Ge(r,e)},has:function(e,t){return t in Ye(e)},ownKeys:function(e){return Reflect.ownKeys(Ye(e))},set:function(e,t,n){if(!e.modified){var r=et(e.base,t),i=n?Oe(r,n)||n===e.drafts[t]:Oe(r,n)&&t in e.base;if(i)return!0;tt(e)}return e.assigned[t]=!0,e.copy[t]=n,!0},deleteProperty:function(e,t){(void 0!==et(e.base,t)||t in e.base)&&(e.assigned[t]=!1,tt(e));e.copy&&delete e.copy[t];return!0},getOwnPropertyDescriptor:function(e,t){var n=Ye(e),r=Reflect.getOwnPropertyDescriptor(n,t);r&&(r.writable=!0,r.configurable=!Array.isArray(n)||"length"!==t);return r},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(e){return Object.getPrototypeOf(e.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},Xe={};function Ye(e){return e.copy||e.base}function et(e,t){var n=e[Pe],r=Reflect.getOwnPropertyDescriptor(n?Ye(n):e,t);return r&&r.value}function tt(e){e.modified||(e.modified=!0,e.copy=Ae(Ne(e.base),e.drafts),e.drafts=null,e.parent&&tt(e.parent))}Le(Ke,function(e,t){Xe[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Xe.deleteProperty=function(e,t){if(isNaN(parseInt(t)))throw new Error("Immer only supports deleting array indices");return Ke.deleteProperty.call(this,e[0],t)},Xe.set=function(e,t,n){if("length"!==t&&isNaN(parseInt(t)))throw new Error("Immer only supports setting array indices and the 'length' property");return Ke.set.call(this,e[0],t,n)};var nt=Object.freeze({willFinalize:function(){},createProxy:Ge});function rt(e,t,n,r){Array.isArray(e.base)?function(e,t,n,r){var i,o,s=e.base,a=e.copy,l=e.assigned;a.length<s.length&&(s=(i=[a,s])[0],a=i[1],n=(o=[r,n])[0],r=o[1]);var c=a.length-s.length,d=0;for(;s[d]===a[d]&&d<s.length;)++d;var u=s.length;for(;u>d&&s[u-1]===a[u+c-1];)--u;for(var p=d;p<u;++p)if(l[p]&&a[p]!==s[p]){var h=t.concat([p]);n.push({op:"replace",path:h,value:a[p]}),r.push({op:"replace",path:h,value:s[p]})}for(var f=u!=s.length,g=n.length,m=u+c-1;m>=u;--m){var y=t.concat([m]);n[g+m-u]={op:"add",path:y,value:a[m]},f&&r.push({op:"remove",path:y})}f||r.push({op:"replace",path:t.concat(["length"]),value:s.length})}(e,t,n,r):function(e,t,n,r){var i=e.base,o=e.copy;Le(e.assigned,function(e,s){var a=i[e],l=o[e],c=s?e in i?"replace":"add":"remove";if(a!==l||"replace"!==c){var d=t.concat(e);n.push("remove"===c?{op:c,path:d}:{op:c,path:d,value:l}),r.push("add"===c?{op:"remove",path:d}:"remove"===c?{op:"add",path:d,value:a}:{op:"replace",path:d,value:a})}})}(e,t,n,r)}function it(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.path;if(0===i.length&&"replace"===r.op)e=r.value;else{for(var o=e,s=0;s<i.length-1;s++)if(!(o=o[i[s]])||"object"!=typeof o)throw new Error("Cannot apply patch, path doesn't resolve: "+i.join("/"));var a=i[i.length-1];switch(r.op){case"replace":o[a]=r.value;break;case"add":Array.isArray(o)?o.splice(a,0,r.value):o[a]=r.value;break;case"remove":Array.isArray(o)?o.splice(a,1):delete o[a];break;default:throw new Error("Unsupported patch operation: "+r.op)}}}return e}var ot={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:"undefined"!=typeof process?"production"!==process.env.NODE_ENV:"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},st=function(e){Ae(this,ot,e),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)};st.prototype.produce=function(e,t,n){var r,i=this;if("function"==typeof e&&"function"!=typeof t){var o=t;t=e;var s=this;return function(e){var n=this;void 0===e&&(e=o);for(var r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];return s.produce(e,function(e){return t.call.apply(t,[n,e].concat(r))})}}if("function"!=typeof t)throw new Error("The first or second argument to `produce` must be a function");if(void 0!==n&&"function"!=typeof n)throw new Error("The third argument to `produce` must be a function or undefined");if(Ee(e)){var a=ze.enter(),l=this.createProxy(e),c=!0;try{r=t(l),c=!1}finally{c?a.revoke():a.leave()}return r instanceof Promise?r.then(function(e){return a.usePatches(n),i.processResult(e,a)},function(e){throw a.revoke(),e}):(a.usePatches(n),this.processResult(r,a))}return void 0===(r=t(e))?e:r!==xe?r:void 0},st.prototype.createDraft=function(e){if(!Ee(e))throw new Error("First argument to `createDraft` must be a plain object, an array, or an immerable object");var t=ze.enter(),n=this.createProxy(e);return n[Pe].isManual=!0,t.leave(),n},st.prototype.finishDraft=function(e,t){var n=e&&e[Pe];if(!n||!n.isManual)throw new Error("First argument to `finishDraft` must be a draft returned by `createDraft`");if(n.finalized)throw new Error("The given draft is already finalized");var r=n.scope;return r.usePatches(t),this.processResult(void 0,r)},st.prototype.setAutoFreeze=function(e){this.autoFreeze=e},st.prototype.setUseProxies=function(e){this.useProxies=e,Ae(this,e?nt:Ze)},st.prototype.applyPatches=function(e,t){return Ce(e)?it(e,t):this.produce(e,function(e){return it(e,t)})},st.prototype.processResult=function(e,t){var n=t.drafts[0],r=void 0!==e&&e!==n;if(this.willFinalize(t,e,r),r){if(n[Pe].modified)throw t.revoke(),new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");Ee(e)&&(e=this.finalize(e,null,t)),t.patches&&(t.patches.push({op:"replace",path:[],value:e}),t.inversePatches.push({op:"replace",path:[],value:n[Pe].base}))}else e=this.finalize(n,[],t);return t.revoke(),t.patches&&t.patchListener(t.patches,t.inversePatches),e!==xe?e:void 0},st.prototype.finalize=function(e,t,n){var r=this,i=e[Pe];if(!i)return Object.isFrozen(e)?e:this.finalizeTree(e,null,n);if(i.scope!==n)return e;if(!i.modified)return i.base;if(!i.finalized){if(i.finalized=!0,this.finalizeTree(i.draft,t,n),this.onDelete)if(this.useProxies){var o=i.assigned;for(var s in o)o[s]||this.onDelete(i,s)}else{var a=i.base,l=i.copy;Le(a,function(e){Te(l,e)||r.onDelete(i,e)})}this.onCopy&&this.onCopy(i),this.autoFreeze&&n.canAutoFreeze&&Object.freeze(i.copy),t&&n.patches&&rt(i,t,n.patches,n.inversePatches)}return i.copy},st.prototype.finalizeTree=function(e,t,n){var r=this,i=e[Pe];i&&(this.useProxies||(i.copy=Ne(i.draft,!0)),e=i.copy);var o=!!t&&!!n.patches,s=function(a,l,c){if(l===c)throw Error("Immer forbids circular references");var d=!!i&&c===e;if(Ce(l)){var u=d&&o&&!i.assigned[a]?t.concat(a):null;if(Ce(l=r.finalize(l,u,n))&&(n.canAutoFreeze=!1),Array.isArray(c)||je(c,a)?c[a]=l:Object.defineProperty(c,a,{value:l}),d&&l===i.base[a])return}else{if(d&&Oe(l,i.base[a]))return;Ee(l)&&!Object.isFrozen(l)&&Le(l,s)}d&&r.onAssign&&r.onAssign(i,a,l)};return Le(e,s),e};var at=new st,lt=at.produce;at.setAutoFreeze.bind(at),at.setUseProxies.bind(at),at.applyPatches.bind(at),at.createDraft.bind(at),at.finishDraft.bind(at);customElements.define("micro-panel-editor-entry",class extends ge{static get properties(){return{defaultctype:{type:String},entry:{type:Object},entryIsNew:{type:Boolean},setEntry:{type:Function},hiddenProps:{type:Object},openUploaders:{type:Object},uploadQueues:{type:Object},openJsonEditors:{type:Object},jsonParseError:{type:Object},media:{type:String},mediatoken:{type:String},cats:{type:Array}}}constructor(){super(),this.hiddenProps={},this.openUploaders={photo:!0,video:!0,audio:!0},this.uploadQueues={photo:[],video:[],audio:[]},this.openJsonEditors={filter:!0,unfilter:!0,"feed-settings":!0,"site-settings":!0,"site-web-push-subscriptions":!0},this.jsonParseError={}}static get styles(){return[ve,he`
				:host { display: block; }
				fieldset {
					border: 0;
					margin: 1rem auto;
					padding: 0;
					box-shadow: rgba(20,20,20,0.24) 0 0 6px;
					border-radius: var(--roundness);
					overflow: hidden;
				}
				header {
					background: var(--light-accent);
					color: var(--neutral);
					padding: 0.15rem 0.5rem;
				}
				.bar button + label {
					margin-left: 0;
				}
				.input-row {
					padding: 0.5rem;
					display: flex;
					align-items: start;
				}
				.input-row + .input-row {
					padding-top: 0;
				}
				.input-row input, .input-row textarea, .input-row code-flask,
				.input-row micro-panel-editor-entry, .input-row .media-editor, .input-row .error-value {
					flex: 1;
				}
				.input-row button {
					margin: 0 0.5rem;
				}
				.input-row button:last-child {
					margin-right: 0;
				}
				.input-row-labeled {
					align-items: baseline;
				}
				textarea, code-flask {
					resize: vertical;
					min-height: 200px;
				}
				.error-value {
					color: #bb1111;
				}
				.json-error {
					background: #bb1111;
					color: #fff;
					padding: 0.5rem;
				}

				.cat-suggest {
					padding: 0.5rem;
					font-size: 1.1em;
					line-height: 2;
				}

				#upload-zone {
					position: relative;
					padding: 0.5rem;
				}
				.drag-overlay {
					display: none;
				}
				.dragging .drag-overlay {
					display: flex;
					align-items: center;
					justify-content: center;
					text-align: center;
					position: absolute;
					top: 0;
					right: 0;
					bottom: 0;
					left: 0;
					background: rgba(60, 60, 60, 0.8);
					color: #fff;
				}
				progress {
					display: block;
					width: 100%;
					margin: 0.1rem 0 0.4rem;
				}

				img, video {
					max-width: 100%;
				}
				.palette-row {
					flex-wrap: wrap;
					line-height: 1.9;
				}
				.palette-color {
					border-right: 1px solid #999;
					padding-right: 0.5rem;
					margin-right: 0.5rem;
				}
				.palette-color:first-of-type {
					margin-left: 0.5rem;
				}
				.palette-color:last-of-type {
					border-right: 0;
				}

				@media screen and (min-width: 700px) {
					:host(.root-editor) fieldset { width: 70%; }
				}
			`]}render(){const{defaultctype:e,entry:t,entryIsNew:n,hiddenProps:r,openUploaders:i,uploadQueues:o,openJsonEditors:s,jsonParseError:a,media:l,mediatoken:c,cats:d}=this;return U`
			${t&&t.type?U`
				<fieldset>
					${t.type.map((e,r)=>U`
						<div class="input-row">
							<input type="text" .value=${e} @change=${e=>this._modify(t,t=>t.type[r]=e.target.value)} ?disabled=${!n}>
							${0!==r&&n?U`
								<button @click=${e=>this._modify(t,e=>e.type.splice(r,1))} title="Delete this type" class="icon-button">${ke(we.minus)}</button>
							`:""}
							${n?U`
								<button @click=${e=>this._modify(t,e=>e.type.push(""))} title="Add new type" class="icon-button">${ke(we.plus)}</button>
							`:""}
						</div>
					`)}
				</fieldset>
			`:""}

			${t&&t.properties&&Object.keys(t.properties).map(n=>U`
				<fieldset>
					<header class="bar">
						<button @click=${e=>{this.hiddenProps=lt(r,e=>{e[n]=!e[n]})}} title="Toggle display of this property" class="icon-button">${ke(r[n]?we.chevronDown:we.chevronUp)}</button>
						<label>${n}</label>
						<button @click=${e=>this._modify(t,e=>{delete e.properties[n],"x-micro-panel-deleted-properties"in e||(e["x-micro-panel-deleted-properties"]=[]),e["x-micro-panel-deleted-properties"].push(n)})} title="Delete this property" class="icon-button">${ke(we.minus)}</button>
						<button @click=${e=>{this.openJsonEditors=lt(s,e=>{e[n]=!e[n]}),this.jsonParseError=lt(a,e=>{e[n]=null})}} title="Edit this property as JSON" class="icon-button">${ke(we.json)}</button>
						${"geolocation"in navigator?U`
							<button @click=${e=>(async function(){const e=await new Promise((e,t)=>navigator.geolocation.getCurrentPosition(e,t));return{type:["h-geo"],properties:{latitude:[e.coords.latitude.toString()],longitude:[e.coords.longitude.toString()]}}})().then(e=>this._modify(t,t=>t.properties[n].push(e))).catch(ye)} title="Add geolocation" class="icon-button">${ke(we.mapMarkerPlus)}</button>
						`:""}
						${l&&!i[n]?U`
							<button @click=${e=>{this.uploadQueues=lt(o,e=>{e[n]=[]}),this.openUploaders=lt(i,e=>{e[n]=!0})}} title="Upload media files" class="icon-button">${ke(we.cloudUpload)}</button>
						`:""}
						<button @click=${e=>this._modify(t,e=>e.properties[n].push(""))} title="Add new value to this property" class="icon-button">${ke(we.plus)}</button>
					</header>
					${r[n]?"":s[n]?this._jsonEditor(t,n,a):t.properties[n]&&t.properties[n].map((r,i)=>U`
						<div class="input-row input-row-labeled">
							${this._rowEditor(t,n,r,i,l,c,d,e)}
							<button @click=${e=>this._modify(t,e=>e.properties[n].splice(i,1))} title="Delete this value" class="icon-button">${ke(we.minus)}</button>
						</div>
					`)}
					${r[n]||"category"!==n?"":U`
						<div class="cat-suggest">
							${[...d].map(e=>t.properties.category.includes(e)?"":U`
								<button @click=${n=>this._modify(t,t=>t.properties.category.push(e))}>${e}</button>
							`)}
						</div>
					`}
					${!r[n]&&i[n]?this._mediaUploader(t,n,l,c,o):""}
				</fieldset>
			`)}

		${t&&t.type&&t.type.length>0&&"h-geo"===t.type[0]?U`
			<fieldset class="input-row">
				<button @click=${e=>(async function({latitude:e,longitude:t}){const n=await fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${encodeURIComponent(e[0])}&lon=${encodeURIComponent(t[0])}`),{address:r}=await n.json(),i={latitude:e,longitude:t,"street-address":[r.road],"extended-address":[r.suburb],locality:[r.hamlet||r.village||r.town||r.city],region:[r.county&&r.state?r.county+", "+r.state:r.state||r.county],"postal-code":[r.postcode],"country-name":[r.country],"country-code":[r.country_code&&r.country_code.toUpperCase()]};for(const e of Object.keys(i))i[e][0]||delete i[e];return i})(t.properties).then(e=>this._modify(t,t=>{t.type[0]="h-adr",t.properties=e})).catch(ye)}>Find street address via Nominatim</button>
			</fieldset>
		`:""}

		<fieldset class="input-row">
			<input type="text" placeholder="Add property..." id="new-prop-inp" @keydown=${e=>this.addNewProp(e,t)}/>
			<button @click=${e=>this.addNewProp(e,t)} class="icon-button">${ke(we.plus)}</button>
		</fieldset>
		`}_rowEditor(e,t,n,r,i,o,s,a){return"site-css"===t&&"string"==typeof n?U`
				<code-flask word-wrap language="css" .value=${n} @value-changed=${n=>this._modify(e,e=>e.properties[t][r]=n.target.value)}></code-flask>
			`:"string"==typeof n?U`
				<input type="text" .value=${n} @change=${n=>this._modify(e,e=>e.properties[t][r]=n.target.value)}/>
			`:null===n?U`<div class="error-value">null</div>`:"object"!=typeof n?U`<div class="error-value">Item of unsupported type ${typeof n}</div>`:"subscriptions"===t?U`
				Feed&nbsp;<input type="url" .value=${n.feed} @value-changed=${n=>this._modify(e,e=>e.properties[t][r].feed=n.target.value)}>&nbsp;entries: ${(n.entries||[]).length}
			`:"type"in n?U`
				<micro-panel-editor-entry
					.media=${i} .mediatoken=${o} .cats=${s} .defaultctype=${a}
					.entry=${n}
					.setEntry=${n=>this._modify(e,e=>e.properties[t][r]=n)}>
				</micro-panel-editor-entry>
			`:"html"in n?U`
				<code-flask word-wrap language="markup" .value=${n.html} @value-changed=${n=>this._modify(e,e=>e.properties[t][r].html=n.target.value)}></code-flask>
			`:"markdown"in n?U`
				<code-flask word-wrap language="markdown" .value=${n.markdown} @value-changed=${n=>this._modify(e,e=>e.properties[t][r].markdown=n.target.value)}></code-flask>
			`:"source"in n?U`
				<div class="media-editor">
					${n.width||n.height?U`
						<div class="input-row">[${n.width}x${n.height}]</div>`:""}
					<div class="input-row">
					${n.source.map(e=>U`
						<figure>
							${e.type&&e.type.startsWith("image")?U`
								<img src=${e.src} alt=""/>
							`:""}
							${e.type&&e.type.startsWith("audio")?U`
								<audio src=${e.src} controls></audio>
							`:""}
							${e.type&&e.type.startsWith("video")?U`
								<video src=${e.src} controls></video>
							`:""}
							<figcaption>
								<a href=${e.src}>${e.type}</a>
							</figcaption>
						</figure>
					`)}
					</div>
					${n.palette?U`
						<div class="input-row input-row-labeled palette-row">
							Palette
							${Object.keys(n.palette).map(i=>U`
								<label class="palette-color">
									<input type="color" value=${n.palette[i].color} @change=${n=>this._modify(e,e=>e.properties[t][r].palette[i].color=n.target.value)}/>
									${i} (${n.palette[i].population})
								</label>
							`)}
						</div>`:""}
					<label class="input-row input-row-labeled">
						Alt text&nbsp;
						<input type="text" value=${n.alt} @change=${n=>this._modify(e,e=>e.properties[t][r].alt=n.target.value)}/>
					</label>
					<div class="input-row input-row-labeled">
						<label for=${`id-${n}`}>
							ID&nbsp;
						</label>
						<input type="text" id=${`id-${n}`} value=${n.id} @change=${n=>this._modify(e,e=>e.properties[t][r].id=n.target.value)}/>&nbsp;
						<code @click=${e=>window.getSelection().selectAllChildren(e.target)}>
							&lt;${t}-here id="${n.id}"&gt;&lt;/${t}-here&gt;
						</code>
					</label>
				</div>
			`:U`<div class="error-value">Unsupported object with keys: ${Object.keys(n).join(", ")}</div>`}_jsonEditor(e,t,n){return U`
			<code-flask word-wrap language="json" .value=${JSON.stringify(e.properties[t],null,2)} @value-changed=${r=>this._modify(e,e=>{try{e.properties[t]=JSON.parse(r.target.value),this.jsonParseError=lt(n,e=>{e[t]=null})}catch(e){this.jsonParseError=lt(n,n=>{n[t]=e.toString()})}})}></code-flask>
			${n[t]?U`<div class="json-error">
				<p><strong>JSON parsing error!</strong> The changes are not saved when this error is present. Please fix the syntax in the editor above. The error is:</p>
				<p><code>${n[t]}</code></p>
			</div>`:""}
		`}_mediaUploader(e,t,n,r,i){return U`
			<div id="upload-zone"
				@dragenter=${e=>{e.stopPropagation(),e.preventDefault(),console.log(this),this.dragFirst?this.dragSecond=!0:(this.dragFirst=!0,e.dataTransfer.dropEffect="copy",this.shadowRoot.getElementById("upload-zone").classList.add("dragging"))}}
				@dragover=${e=>{e.stopPropagation(),e.preventDefault()}}
				@dragleave=${e=>{e.stopPropagation(),e.preventDefault(),this.dragSecond?this.dragSecond=!1:this.dragFirst=!1,this.dragFirst||this.dragSecond||this.shadowRoot.getElementById("upload-zone").classList.remove("dragging")}}
				@drop=${e=>{e.stopPropagation(),e.preventDefault(),this.dragFirst=!1,this.dragSecond=!1,this.shadowRoot.getElementById("upload-zone").classList.remove("dragging"),this.uploadQueues=lt(i,n=>{for(const r of e.dataTransfer.files)n[t].push({file:r}),console.log(r)})}}>
				Drag'n'drop or select <input type="file" multiple @change=${e=>{this.uploadQueues=lt(i,n=>{for(const r of e.target.files)n[t].push({file:r}),console.log(r)})}}>
				to upload.
				${i[t].length>0?U`
					<div class="upload-queue">
						${i[t].map(({file:e,progress:n},r)=>U`
							<div class="upload-queue-file bar">
								<div class="stretchy">
									<div>${e.name}</div>
									${n?U`<progress max="100" value=${n}>${n}%</progress>`:""}
								</div>
								<button @click=${e=>this.uploadQueues=lt(i,e=>{e[t].splice(r,1)})} title="Delete this file from the queue" class="icon-button">${ke(we.minus)}</button>
							</div>
						`)}
					</div>
					<button @click=${async e=>{for(const[o,s]of i[t].entries())try{const i=await be(n,r,s.file,e=>this.uploadQueues=lt(this.uploadQueues,n=>{const r=n[t].findIndex(e=>e.file===s.file);e.lengthComputable?n[t][r].progress=e.loaded/e.total*100:n[t][r].progress="ind"}));this._modify(this.entry,e=>{e.properties[t].push(i)}),this.uploadQueues=lt(this.uploadQueues,e=>{e[t].splice(e[t].findIndex(e=>e.file===s.file),1)})}catch(e){ye(e)}}}>Upload!</button>
				`:""}
				<div class="drag-overlay">
					Drop files here!
				</div>
			</div>
		`}addNewProp(e,t){if("key"in e&&"Enter"!==e.key)return;const n=this.shadowRoot.getElementById("new-prop-inp"),r=n.value;this._modify(t,e=>{r.length>0&&!(r in e.properties)&&(e.properties[r]="photo"===r||"video"===r||"audio"===r||"location"===r?[]:"content"===r?[{[this.defaultctype]:""}]:[""],"x-micro-panel-deleted-properties"in e&&(e["x-micro-panel-deleted-properties"]=e["x-micro-panel-deleted-properties"].filter(e=>e!==r)))}),n.value=""}_modify(e,t){this.setEntry(lt(e,e=>{t(e)}))}});customElements.define("micro-panel-editor",class extends ge{static get properties(){return{micropub:{type:String},media:{type:String},mediatoken:{type:String},defaultctype:{type:String},originalUrl:{type:String},entry:{type:Object},entryIsNew:{type:Boolean},entryIsModified:{type:Boolean},requestInFlight:{type:Boolean},cats:{type:Array}}}constructor(){super(),this.cats=new Set;for(const e of document.querySelectorAll("[data-mf-category]")){const t=e.dataset.mfCategory.trim();t.length>0&&this.cats.add(t)}}connectedCallback(){super.connectedCallback();const e=new URLSearchParams(document.location.search.substring(1));e.has("mp-reaction")&&(e.has("with")?this.newReaction(e.get("mp-reaction"),e.get("with"),e.get("content")):this.newEntry({name:[],content:[{[this.defaultctype||"html"]:e.get("content")}],category:[],photo:[]}))}static get styles(){return[ve,he`
				:host {
					display: flex;
					flex-direction: column;
					position: fixed;
					top: 0;
					bottom: 0;
					left: 0;
					right: 0;
					background: var(--neutral);
					z-index: 69420;
				}
				#root-editor {
					flex: 1;
					overflow-y: auto;
					-webkit-overflow-scrolling: touch;
					padding: var(--major-padding);
				}
			`]}render(){const{micropub:e,media:t,mediatoken:n,defaultctype:r,originalUrl:i,entry:o,entryIsNew:s,entryIsModified:a,cats:l}=this;return U`
			<header class="bar header-bar inverted">
				<button @click=${e=>this.close()} class="icon-button">${ke(we.close)}</button>
				<slot name="title"><h1>micro-panel editor</h1></slot>
				${i?U`
					<button @click=${e=>this.deleteEntry()}>Delete</button>
				`:""}
				${s?U`
					<button @click=${e=>this.createEntry()} ?disabled=${!a}>Create</button>
				`:U`
					<button @click=${e=>this.updateEntry()} ?disabled=${!a}>Save</button>
				`}
			</header>

			<micro-panel-editor-entry id="root-editor" class="root-editor"
				.media=${t} .mediatoken=${n} .cats=${l} .defaultctype=${r}
				.entry=${o} .entryIsNew=${s}
				.setEntry=${e=>{this.entry=e,this.entryIsModified=!0}}></micro-panel-editor-entry>

		`}async close(){this.entryIsModified&&!confirm("Abandon current modified entry?")||("animate"in this&&"Animation"in window&&"finished"in Animation.prototype&&await this.animate({transform:["none","translateY(100vh)"]},{duration:300,easing:"ease-out"}).finished,this.hidden=!0,document.body.style.overflow=this.oldBodyOverflow)}show(){this.oldBodyOverflow=document.body.style.overflow,document.body.style.overflow="hidden",this.hidden=!1,"animate"in this&&this.animate({transform:["translateY(100vh)","none"]},{duration:300,easing:"ease-out"})}async editEntry(e){var t,n;this.entry=await(await(t=this.micropub,n=`q=source&url=${encodeURIComponent(e)}`,fetch(-1===t.indexOf("?")?t+"?"+n:t+"&"+n,{credentials:"include",headers:{Accept:"application/json"}}))).json(),this.entry.properties||(this.entry.properties={});for(const e of Object.keys(this.entry.properties))this.entry.properties[e]||(this.entry.properties[e]=[]);this.entry.properties.url||(this.entry.properties.url=[]),this.entry.properties.url.length<1&&this.entry.properties.url.push(e),this.originalUrl=this.entry.properties.url[0],this.entryIsNew=!1,this.entryIsModified=!1,this.show()}newEntry(e={name:[],content:[{[this.defaultctype||"html"]:""}],category:[],photo:[],location:[]}){this.entry={type:["h-entry"],properties:e},this.originalUrl=void 0,this.entryIsNew=!0,this.entryIsModified=!1,this.show()}newReaction(e,t,n){this.newEntry({[e]:[t],content:[{[this.defaultctype]:n||""}],photo:[]}),this.entryIsModified=!0}createEntry(){this._post({type:this.entry.type,properties:this.entry.properties})}updateEntry(){const e=this.originalUrl||((this.entry.properties||{}).url||[null])[0];if(!e)return alert("Somehow, an entry with no URL! I have no idea how to save that.");this._post({action:"update",url:e,replace:this.entry.properties,delete:this.entry["x-micro-panel-deleted-properties"]||[]})}deleteEntry(){if(!this.originalUrl)return alert("Somehow, an entry with no URL! I have no idea how to delete that.");confirm("Delete this entry?")&&this._post({action:"delete",url:this.originalUrl})}async _post(e){let t;this.requestInFlight=!0;try{t=await function(e,t,n,r){const i={Accept:"application/json","Content-Type":"application/json"};return n&&r&&(i[n]=r),fetch(e,{method:"post",credentials:"include",headers:i,body:JSON.stringify(t)})}(this.micropub,e,this.getAttribute("csrfheader"),this.getAttribute("csrftoken"))}catch(e){return void alert(`Couldn't save the entry! Got error: ${e}`)}finally{this.requestInFlight=!1}t.status>=300?alert(`Couldn't save the entry! Got status: ${t.status}`):(this.entryIsModified=!1,this.close(),location.href=t.headers.has("Location")?t.headers.get("Location"):this.entry.properties.url[0])}});customElements.define("micro-panel-toolbar",class extends ge{static get properties(){return{}}static get styles(){return[ve,he`
				:host {
					display: block;
				}
			`]}render(){return U`
			<header class="bar header-bar inverted">
				<slot name="title"><h1>micro-panel</h1></slot>
				<button @click=${e=>me().editEntry(location.href)}>${ke(we.leadPencil)} Edit</button>
				<button @click=${e=>me().newEntry()}>${ke(we.plus)} New</button>
			</header>
		`}});function ct(e){switch(e){case"like":return"like-of";case"repost":return"repost-of";case"bookmark":return"bookmark-of";case"quotation":return"quotation-of";case"tag":return"tag-of";default:return"in-reply-to"}}customElements.define("micro-panel-action",class extends HTMLElement{connectedCallback(){for(const e of this.querySelectorAll("a, button"))e.addEventListener("click",e=>me().editEntry(this.getAttribute("with")))}});customElements.define("indie-action",class extends HTMLElement{connectedCallback(){for(const e of this.querySelectorAll("a, button"))e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),me().newReaction(ct(this.getAttribute("do")),this.getAttribute("with"))})}})}();
//# sourceMappingURL=micro-panel-all.bundle.min.js.map
